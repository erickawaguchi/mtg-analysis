CREATE TYPE format AS ENUM (
    'standard',
    'modern',
    'legacy'
);

CREATE TABLE tournament_info (
    name TEXT,
    date DATE,
    format FORMAT NOT NULL,
    url TEXT NOT NULL,
    PRIMARY KEY (name, date)
);

CREATE TABLE tournament_entry (
    entry_id SERIAL PRIMARY KEY,
    tournament TEXT NOT NULL,
    date DATE NOT NULL,
    archetype TEXT NOT NULL,
    place TEXT NOT NULL,
    player TEXT NOT NULL,
    name TEXT NOT NULL,
    url TEXT NOT NULL,
    UNIQUE (tournament, date, archetype, place, player),
    FOREIGN KEY (tournament, date) REFERENCES tournament_info (name, date)
);

CREATE TABLE entry_card (
    entry_id INTEGER,
    card TEXT,
    mainboard BOOLEAN,
    quantity INTEGER NOT NULL,
    CONSTRAINT positive_quantity CHECK (quantity > 0),
    PRIMARY KEY (entry_id, card, mainboard),
    FOREIGN KEY (entry_id) REFERENCES tournament_entry(entry_id)
);

